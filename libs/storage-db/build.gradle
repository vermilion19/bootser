plugins {
    id 'java-library'
    id 'java-test-fixtures' // ğŸ‘ˆ [í•µì‹¬] ì´ í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€!
}

dependencies {
    // 1. JPA (ìë°” í‘œì¤€ ORM) - í•„ìˆ˜
    api 'org.springframework.boot:spring-boot-starter-data-jpa'

    // 2. PostgreSQL ë“œë¼ì´ë²„ (ëŸ°íƒ€ì„ì—ë§Œ í•„ìš”)
    // ë‚˜ì¤‘ì— ì‹¤ì œ DB ë¶™ì¼ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì§€ê¸ˆ ë‹¹ì¥ DBê°€ ì—†ì–´ë„ ì½”ë“œëŠ” ë¬¸ì œì—†ìŠµë‹ˆë‹¤.
    runtimeOnly 'org.postgresql:postgresql'

    // 3. (ì„ íƒ) H2 Database (í…ŒìŠ¤íŠ¸ìš©)
    // ë¡œì»¬ì— PostgreSQL ê¹”ê¸° ê·€ì°®ì„ ë•Œ, ë©”ëª¨ë¦¬ DBë¡œ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ ë„£ì–´ë‘ë©´ ì¢‹ìŠµë‹ˆë‹¤.
    runtimeOnly 'com.h2database:h2'
    testImplementation 'com.h2database:h2'

    // [QueryDSL]
    // Spring Boot 3.x, 4.x ëª¨ë‘ 'jakarta' ë²„ì „ ì‚¬ìš© í•„ìˆ˜
    api "com.querydsl:querydsl-jpa:5.0.0:jakarta"

    // QClass ìƒì„±ìš© (Annotation Processor)
    annotationProcessor "com.querydsl:querydsl-apt:5.0.0:jakarta"
    // ì•„ë˜ ë‘ ê°œëŠ” QueryDSL ì»´íŒŒì¼ ì‹œ ì¶©ëŒ ë°©ì§€ë¥¼ ìœ„í•´ ëª…ì‹œì ìœ¼ë¡œ ë„£ì–´ì£¼ëŠ” ê²Œ ì•ˆì „í•¨ (javax -> jakarta ì´ìŠˆ í•´ê²°)
    annotationProcessor "jakarta.annotation:jakarta.annotation-api"
    annotationProcessor "jakarta.persistence:jakarta.persistence-api"

    testFixturesApi 'org.springframework.boot:spring-boot-testcontainers:4.0.1'
    testFixturesApi 'org.testcontainers:junit-jupiter:1.21.4'
    testFixturesApi 'org.testcontainers:postgresql:1.21.4'

}

// QueryDSL QClass ìƒì„± ê²½ë¡œ ì„¤ì •
// ë³´í†µ build/generated/querydsl ìª½ì— ìƒê¸°ë„ë¡ í•¨
def querydslDir = "$buildDir/generated/querydsl"

tasks.withType(JavaCompile) {
    options.getGeneratedSourceOutputDirectory().set(file(querydslDir))
}

sourceSets {
    main.java.srcDirs += [ querydslDir ]
}

clean {
    delete file(querydslDir)
}